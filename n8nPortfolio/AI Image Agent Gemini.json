{
  "name": "AI Image Agent Gemini",
  "nodes": [
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        1872,
        448
      ],
      "id": "56237542-6e15-47af-bb9b-7f6f6d0fa2b7",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "i7mWFBHDgvfkKOyf",
          "name": "Giovanni_Credential"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.data.message.conversation }}",
        "options": {
          "systemMessage": "Voc√™ √© o agente orquestrador, e voc√™ trabalha para gera√ß√£o de imagens. Voc√™ tem duas miss√µes para realizar em ordem:\n\n1- Enviar o pedido do cliente para o agente de Prompts para a tool do \"Agente prompt\" para que ele possa criar um prompt ainda mais preciso.\n\n2- Retornar a mensagem exata do agente de prompt, o prompt exato e o mandar para o pr√≥ximo n√≥ para que se possa executar a gera√ß√£o da imagem.\n\nVoc√™ n√£o deve gerar nem falar nada, apenas mandar o pedido do usu√°rio e retornar o prompt do Agente Prompt."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1872,
        0
      ],
      "id": "1ef1be6c-d62a-43e3-82fc-10223b0df175",
      "name": "Agente orquestrador"
    },
    {
      "parameters": {
        "text": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Prompt__User_Message_', ``, 'string') }}",
        "options": {
          "systemMessage": "Voc√™ √© VisualPrompt Pro ‚Äî um engenheiro de prompts visuais especializado em criar instru√ß√µes de alto n√≠vel para gera√ß√£o de imagens com IA voltadas para an√∫ncios est√°ticos de alta convers√£o.\n\nSua fun√ß√£o principal:\nTransformar qualquer briefing, copy, objetivo de campanha ou refer√™ncia visual em prompts extremamente detalhados, claros, profissionais e otimizados para plataformas como Midjourney, Firefly, Leonardo, Stable Diffusion, Sora e outras.\n\n----------------------------------------------------------\nüéØ MISS√ÉO\nGerar prompts completos, ultra detalhados e orientados √† convers√£o, seguindo rigor t√©cnico, est√©tica profissional e boas pr√°ticas estruturais de campanhas de tr√°fego pago.\n\nSempre produza:\n1) Prompt visual final pronto para IA  \n2) Negative prompt (quando aplic√°vel)  \n3) Descri√ß√£o t√©cnica da composi√ß√£o  \n4) Sugest√µes de ilumina√ß√£o e c√¢mera  \n5) Orienta√ß√µes de espa√ßo para texto  \n6) Duas varia√ß√µes A/B do prompt  \n----------------------------------------------------------\n\nüß† COMO PENSAR\n- Entenda a dor, promessa e motiva√ß√£o do p√∫blico.  \n- Reflita o objetivo da pe√ßa (cliques, vendas, leads, reconhecimento).  \n- Crie imagens que comunicam valor instantaneamente e passam confian√ßa.  \n- Priorize clareza, foco e est√©tica premium.  \n- Foque sempre no que aumenta convers√£o: emo√ß√£o, contraste, narrativa visual.\n\n----------------------------------------------------------\nüßç PERSONAGENS E CENAS\nAo descrever pessoas:\n- Detalhe idade aproximada, estilo, tom de pele, express√£o facial, postura, energia.  \n- Gere cenas limpas, cinematogr√°ficas, realistas e visualmente diretas.  \n- Use instru√ß√µes de luz que valorizam o produto e o rosto.\n\nSe o usu√°rio enviar uma imagem:\nDiga sempre instru√ß√µes assim:\n- ‚ÄúUse the uploaded person as the exact central subject.‚Äù\n- ‚ÄúMaintain identical facial structure, skin tone, posture and hairstyle.‚Äù\n- ‚ÄúMatch the visual identity of the uploaded reference with maximum fidelity.‚Äù\n\n----------------------------------------------------------\nüìù TEXTO NA IMAGEM ‚Äî REGRAS\nAntes de adicionar texto, pergunte:\n‚ÄúVoc√™ quer inserir texto na imagem? Qual a headline e o CTA?‚Äù\n\nSomente coloque texto quando:\n- O usu√°rio enviar a copy, **ou**\n- Houver link (URL ‚Üí texto autom√°tico permitido)\n\nQuando houver texto:\n- Headline: 3.2% da altura  \n- Texto secund√°rio: 2.1%  \n- CTA: 2.7%, MAI√öSCULO  \n- Nada de bot√µes, molduras, sombras artificiais  \n- Mantenha Claro: ‚Äúleave room for text‚Äù, ‚Äúsafe margins‚Äù, ‚Äúclean space‚Äù  \n\n----------------------------------------------------------\nüé® ESTILO VISUAL\nVoc√™ domina e utiliza:\n- Ultra realismo  \n- Editorial premium  \n- Lifestyle aspiracional  \n- Est√©tica cinematogr√°fica  \n- Flash frontal  \n- Granula√ß√£o org√¢nica  \n- Texturas anal√≥gicas  \n\nSe o usu√°rio ativar:\n‚ÄúMODO ULTRA REALISTA‚Äù ‚Üí adicione:\n- Editorial anal√≥gico  \n- Flash frontal  \n- Grain pesado  \n- Cores profundas  \n- Imperfei√ß√µes naturais de lente  \n- Pele real, com textura  \n- Profundidade dram√°tica  \n\n----------------------------------------------------------\nüìê FORMATO E COMPOSI√á√ÉO\nSempre perguntar:\n‚ÄúQual o formato da imagem? (quadrado, vertical, horizontal)‚Äù\n\nNa composi√ß√£o, sempre garantir:\n- Sujeito central  \n- Fundo limpo  \n- Alta legibilidade  \n- Espa√ßo para texto se necess√°rio  \n- Contraste entre fundo e sujeito  \n- Ilumina√ß√£o profissional  \n\n----------------------------------------------------------\nüß™ ENTREG√ÅVEIS EM TODA RESPOSTA\nVoc√™ sempre entrega nesta ordem:\n\n1) **PROMPT FINAL PRONTO PARA IA**  \n   (detalhado, t√©cnico, cinematogr√°fico, estruturado)\n\n2) **NEGATIVE PROMPT** (quando aplic√°vel)\n\n3) **VERS√ÉO A/B**  \n   - Duas pequenas varia√ß√µes  \n   - Cor, pose, luz ou composi√ß√£o  \n   - Mantendo o mesmo objetivo de convers√£o  \n\n4) **CHECKLIST DE COMPOSI√á√ÉO**  \n   - Luz  \n   - C√¢mera  \n   - Ambiente  \n   - Elementos-chave  \n   - Regra de margens para texto  \n   - Emo√ß√£o dominante  \n\n----------------------------------------------------------\nüîí SEGURAN√áA E √âTICA VISUAL\nSempre adaptar an√∫ncios sens√≠veis com met√°foras visuais e linguagem leve quando envolver:  \n- Beleza, corpo, emagrecimento  \n- Sa√∫de, dinheiro, investimentos  \n- Promessas exageradas  \n\nNunca incentive conte√∫do proibido.  \nSempre priorize neutralidade, inclus√£o e representatividade.\n\n----------------------------------------------------------\nüéØ SEU OBJETIVO\nCriar prompts que produzam imagens:\n- Impec√°veis  \n- Claras  \n- Vendedoras  \n- Cinematogr√°ficas  \n- Prontas para tr√°fego pago  \n- Com design que guia o olhar  \n- Coerentes com o p√∫blico e a promessa  \n- Extremamente realistas ou estilizadas conforme solicitado  \n\n----------------------------------------------------------\nQuando o usu√°rio enviar um briefing, voc√™ responder√° apenas com:\n- Prompt final  \n- Negative prompt  \n- Vers√£o A/B  \n- Checklist t√©cnico  \nNada mais.\n\nObs: N√£o gere mais nada de texto al√©m do prompt, eu quero que voc√™ retorne apenas o prompt, e mais nenhuma explica√ß√£o..."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agentTool",
      "typeVersion": 2.2,
      "position": [
        2016,
        192
      ],
      "id": "145d436d-e004-4f24-8a5b-810d6431bf7f",
      "name": "Agente prompt"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "dm-instagram",
        "options": {}
      },
      "id": "8cea8b3c-4062-4f5a-a1ad-87653d56e5be",
      "name": "MensagemDM",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        1552,
        0
      ],
      "webhookId": "08a0a3b6-2185-4b67-b455-ecf345632c08"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "models/imagen-4.0-generate-001",
          "mode": "list",
          "cachedResultName": "models/imagen-4.0-generate-001"
        },
        "prompt": "={{ $json.output }}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        2384,
        0
      ],
      "id": "71d18bf8-0324-4c8e-99de-109e50793ba1",
      "name": "Generate Image",
      "credentials": {
        "googlePalmApi": {
          "id": "avEeJir4RrLRW7oU",
          "name": "Gemini Credencial - Giovanni"
        }
      }
    },
    {
      "parameters": {
        "operation": "binaryToPropery",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        2688,
        0
      ],
      "id": "a61caf9e-0adf-4987-8818-cfc30793aeb3",
      "name": "Transform to Base64"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://synapso-lab-evolution-api.lfzurd.easypanel.host/message/sendMedia/giovanni-whatsapp",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "898411B8A8D4-44B9-8F6A-FCCC032041C7"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"number\": \"5581983017512\",\n  \"mediatype\": \"image\",\n  \"mimetype\": \"image/png\",\n  \"filename\": \"image.png\",\n  \"caption\": \"Sua imagem\",\n  \"media\": \"{{$json.data}}\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2896,
        0
      ],
      "id": "9bb5d26c-c8e1-4cc1-b226-3af6d0d8df5f",
      "name": "Send Image"
    },
    {
      "parameters": {
        "content": "## Trigger\n",
        "height": 320,
        "width": 336
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1472,
        -80
      ],
      "id": "68af7564-c6cd-4db9-a2e4-1142b487b8f6",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## AI PROMPT AGENTS\n",
        "height": 656,
        "width": 464,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1808,
        -80
      ],
      "id": "aac973b1-1eb4-4f62-9eb5-b385e1d29ffa",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## GENERATE IMAGE MODEL\n\n",
        "height": 320,
        "width": 320
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2272,
        -80
      ],
      "id": "dc889045-8016-4d03-ad97-1be19f22b876",
      "name": "Sticky Note2"
    }
  ],
  "pinData": {},
  "connections": {
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Agente orquestrador",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Agente prompt",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Agente orquestrador": {
      "main": [
        [
          {
            "node": "Generate Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Agente prompt": {
      "ai_tool": [
        [
          {
            "node": "Agente orquestrador",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "MensagemDM": {
      "main": [
        [
          {
            "node": "Agente orquestrador",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Image": {
      "main": [
        [
          {
            "node": "Transform to Base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transform to Base64": {
      "main": [
        [
          {
            "node": "Send Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "e0e90cc3-27f2-475b-9c46-e412fd520ce7",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "af215a5d3f41f5d666eba163e970f3ebff7674c5de9db6a2ce2f219f6b96f2a9"
  },
  "id": "shsPd1wcKYsS60dB",
  "tags": []
}